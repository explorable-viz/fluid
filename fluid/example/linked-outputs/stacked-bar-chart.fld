let totalFor year country rows =
   let [ row ] = [ row | row <- rows, row.year == year, row.country == country ]
   in row.nuclearOut + row.gasOut + row.coalOut + row.petrolOut;
let stack year = [ { y: country, z: totalFor year country nonRenewables }
                 | country <- ["BRA", "EGY", "IND", "JPN"] ]
in BarChart {
   caption: "Non-renewables by country",
   data: [ { x: numToStr year, bars: stack year }
         | year <- [2014..2018] ]
}
